
document.addEventListener(
	"DOMContentLoaded", () => {
		let elementToggle = function(element) {
    if (document.querySelector(element)) {
        document.addEventListener('click', function(e) {
            if (e.target.closest(element)) {
                e.preventDefault();
                e.target.closest(element).classList.toggle('toggle');
            };
        });
    };
};
elementToggle('.footer__col');


let classToggler = function(elementBtn, elementTarget) {
    if (document.querySelector(elementBtn) && document.querySelector(elementTarget)) {
        document.querySelector(elementBtn).addEventListener('click', function () {
            document.querySelector(elementTarget).classList.toggle('toggle');
            document.querySelector(elementBtn).classList.toggle('toggle');
        });
    };
};


let movingConstructor = function(to, metod, block) {
    if (!(document.querySelector(block) && document.querySelector(to))) {        
        return;
    } else {
        switch (metod) {
            case 'prepend':
                document.querySelector(to).prepend(document.querySelector(block));
                break;

            case 'before':
                document.querySelector(to).before(document.querySelector(block));
                break;

            case 'after':
                document.querySelector(to).after(document.querySelector(block));
                break;

            default:
                document.querySelector(to).append(document.querySelector(block));
                break;
        };
    }
};


let moving = function () {
    const windowWidth = window.innerWidth;
    
    if (windowWidth <= 1200) {
        movingConstructor('.mobile-menu__wrapper', 'append', '.jsMenu');
        
    } else {
        movingConstructor('.header__nav', 'prepend', '.jsMenu');
        
    };
    
};

moving();
window.addEventListener('resize', moving);function loadData() {
	return new Promise((resolve, reject) => {
		setTimeout(resolve, 100);
	})
};

loadData()
	.then(() => {
		let preloaderEl = document.getElementById('preloader');
		preloaderEl.classList.add('hidden');
		preloaderEl.classList.remove('visible');
	});if (document.querySelector('.js-burger')) {

    const btnBurger = document.querySelectorAll('.js-burger');

    function btnBurgerToggle(e) {
        e.target.classList.toggle('toggle');
    }

    btnBurger.forEach(element => {
        element.addEventListener("click", btnBurgerToggle);
    });
};




function initSwiper() {

	if (document.querySelector('.jsB05Slider')) {
		const jsB10Slider = new Swiper('.jsB05Slider', {
			spaceBetween: 10,
			slidesPerView: 1,
			centeredSlides: true,

			pagination: {
				el: ".b05-slider-pagination",
				type: "fraction",
			},

			navigation: {
				nextEl: ".jsB05Slider__next",
				prevEl: ".jsB05Slider__prev",
			},
		});
	};

	if (document.querySelector('.jsB10Slider')) {
		const jsB10Slider = new Swiper('.jsB10Slider', {
			spaceBetween: 10,
			slidesPerView: 1.05,

			breakpoints: {
				500: {
					slidesPerView: 1.8,
					spaceBetween: 10,
				},
				768: {
					slidesPerView: 2.4,
					spaceBetween: 20,
				},
				1401: {
					slidesPerView: 2.43,
					spaceBetween: 20,
				},
			},
		});
	};

	if (document.querySelector('.jsB11Slider')) {
		const jsB10Slider = new Swiper('.jsB11Slider', {
			spaceBetween: 8,
			slidesPerView: 1.1,
			loop: true,
			breakpoints: {
				500: {
					slidesPerView: 1.8,
					loop: true,
				},
				768: {
					slidesPerView: 2.4,
					loop: true,
				},
				1401: {
					slidesPerView: 4,
					loop: false,
				},
			},
			navigation: {
				nextEl: ".products-list__next",
				prevEl: ".products-list__prev",
			},
		});
	};

};


window.addEventListener("resize", function () {
	initSwiper();
});

initSwiper();


function initInputMask() {
	let formPhone = document.querySelectorAll('.form__phone');
	formPhone.forEach(element => {
		Inputmask({ "mask": "+7 (999) 999-99-99" }).mask(element);
	});
}

initInputMask();if (document.querySelector('.jsMobileMenuBtnToggle')) {

    let menuPanelInit = function () {
        const menuBtn = document.querySelector('.jsMobileMenuBtnToggle');
        const menu = document.querySelector('.mobile-menu');
        const body = document.querySelector('body');

   
        function menuPanelToggle() {
            if (menuBtn.classList.contains('toggle')) {
                menu.classList.add('toggle');
                body.classList.add('toggle');
            } else {
                menu.classList.remove('toggle');
                body.classList.remove('toggle');
            };
        };


        function menuPanelPosition() {
            const heightViewport = document.documentElement.clientHeight;
            const heightHeader = document.querySelector('.header').offsetHeight;
            const heightMenuOverlay = heightViewport - heightHeader;
            let posTop = window.scrollY;
    
            const menuActive = document.querySelector('.mobile-menu.toggle');

            if (menuActive) {
                menuActive.style.height = heightMenuOverlay + 'px';
                menuActive.style.top = posTop + heightHeader + 'px';
            };
        };
    

        function menuPanelClose() {
            menuBtn.classList.remove('toggle');
            menu.classList.remove('toggle');
            body.classList.remove('toggle');
        };


        function menuPanelOnClickClose() {
            document.addEventListener("click", function(e) {
                const target = e.target;
                const its_menu = target == menu || menu.contains(target);
                const its_btnMenu = target == menuBtn;
    
                if (!its_menu && !its_btnMenu) {
                    menuPanelClose();
                };
            });
        };


        window.addEventListener('resize', function () {
            menuPanelClose();
        }, true);


        let menuLaunch = function() {
            menuPanelToggle();
            menuPanelOnClickClose();
        };

        menuBtn.addEventListener("click", menuLaunch);



        // Добфвляем в панель лого, телефон, почту, соцкнопки, кнопку закрытия панели
        let addElementsInPanel = function() {

            let logo = document.querySelector('.header__logo').cloneNode(true);
            document.querySelector('.mobile-menu__wrapper').prepend(logo);

            let socbtns = document.querySelector('.footer__social').cloneNode(true);
            document.querySelector('.mobile-menu__bottom').prepend(socbtns);
            
            let mail = document.querySelector('.footer__mail').cloneNode(true);
            document.querySelector('.mobile-menu__bottom').prepend(mail);

            let phone = document.querySelector('.header__phone').cloneNode(true);
            document.querySelector('.mobile-menu__bottom').prepend(phone);

            let closeMobileMenuButton = document.createElement('button');
            closeMobileMenuButton.classList.add('mobile-menu__close');    
            document.querySelector('.mobile-menu').append(closeMobileMenuButton);

            closeMobileMenuButton.addEventListener("click", function () {
                menuPanelClose();
            });

        };

        addElementsInPanel();

    };

    menuPanelInit();

};

let toggleMobileSubmenu = function () {

	if (document.querySelector('.nav-list__item--dropdown')) {

		if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i.test(navigator.userAgent)) {

			let navLinksDown = document.querySelectorAll('.nav-list__item--dropdown');

			navLinksDown.forEach(function(element) {
				element.addEventListener('click', function(e) {
					e.preventDefault();
					element.classList.toggle('toggle');
				});
			});
		};
	};
};

toggleMobileSubmenu();AOS.init({
			duration: 1200,
			easing: 'ease',
		});
	}
);
